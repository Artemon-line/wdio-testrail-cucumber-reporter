<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"wdio-testrail-cucumber-reporter.js.html":{"id":"wdio-testrail-cucumber-reporter.js.html","title":"Source: wdio-testrail-cucumber-reporter.js","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Source: wdio-testrail-cucumber-reporter.js /** * @module lib/WdioTestRailCucumberReporter * @requires events * @requires ./test-rail * @requires mocha-testrail-reporter/dist/lib/shared * @requires mocha-testrail-reporter/dist/lib/testrail.interface */ const events = require('events'); const TestRail = require('./test-rail'); const titleToCaseIds = require('mocha-testrail-reporter/dist/lib/shared').titleToCaseIds; const Status = require('mocha-testrail-reporter/dist/lib/testrail.interface').Status; /** * Class representing Cucumber reporter data and methods * @extends events.EventEmitter */ class WdioTestRailCucumberReporter extends events.EventEmitter { /** * @param {{}} baseReporter - Configured in wdio.conf file * @param {Object} config - wdio config proprties * @param {Object} config.testRailsOptions - wdio TestRail specifc configurations * @param {string} config.testRailsOptions.domain - Domain for TestRail * @param {number} config.testRailsOptions.projectId - Project identifier * @param {Array.&lt;number&gt;} config.testRailsOptions.suiteId - List of suites identifiers * @param {number} config.testRailsOptions.assignedToId - User identifier * @param {string} config.testRailsOptions.username - User email * @param {string} config.testRailsOptions.password - User API key * @param {Boolean} config.testRailsOptions.includeAll - Flag to inlcude all tests from a suite in a run * @param {number} config.testRailsOptions.updateRun - Test run identifier for test run to update * @param {number} config.testRailsOptions.updatePlan - Test plan identifier for a test plan to update */ constructor(baseReporter, config) { super(); this.reporterName = 'WebDriver.io Cucumber TestRail Reporter'; const options = config.testRailsOptions; this._results = []; this._passes = 0; this._fails = 0; this._pending = 0; this._out = []; this.testRail = new TestRail(options); this.on('test:pending', (test) =&gt; { this._pending++; this._out.push(test.title + ': pending'); }); this.on('test:pass', (test) =&gt; { this._passes++; this._out.push(test.title + ': pass'); let caseIds = titleToCaseIds(test.parent); //look in the parent for the testrail id (represents a scenario or scenario outline) if (caseIds.length &gt; 0) { let results = caseIds.map(caseId =&gt; { return { case_id: caseId, status_id: Status.Passed, comment: `${test.title}` }; }); this._results.push(...results); } }); this.on('test:fail', (test) =&gt; { this._fails++; this._out.push(test.title + ': fail'); let caseIds = titleToCaseIds(test.parent); if (caseIds.length &gt; 0) { let results = caseIds.map(caseId =&gt; { return { case_id: caseId, status_id: Status.Failed, comment: `${test.title} ${test.err.message} ${test.err.stack} ` }; }); this._results.push(...results); } }); this.on('end', () =&gt; { if (this._results.length == 0) { console.warn(&quot;No testcases were matched. Ensure that your tests are declared correctly and matches TCxxx\\n&quot; + &quot;You may use script generate-cases to do it automatically.&quot;); return; } const executionDateTime = new Date(); const total = this._passes + this._fails + this._pending; const runName = options.runName || WdioTestRailReporter.reporterName; const name = `${runName}: automated test run ${executionDateTime}`; const description = `${name} Execution summary: Passes: ${this._passes} Fails: ${this._fails} Pending: ${this._pending} Total: ${total} `; this.testRail.publish(name, description, this._results); }); } } module.exports = WdioTestRailCucumberReporter; Ã— Search results Close npm Module "},"test-rail.js.html":{"id":"test-rail.js.html","title":"Source: test-rail.js","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Source: test-rail.js const request = require('sync-request'); /** * TestRail basic API wrapper */ class TestRail { /** * @param {{domain, projectId, suiteId, assignedToId, username, password, includeAll, updateRun, updatePlan}} options */ constructor(options) { this._validate(options, 'domain'); this._validate(options, 'username'); this._validate(options, 'password'); this._validate(options, 'projectId'); this._validate(options, 'suiteId'); this._validate(options, 'includeAll'); // compute base url this.options = options; this.base = `https://${options.domain}/index.php`; } /** * @param {{}} options * @param {string} name * @private */ _validate(options, name) { if (options == null) { throw new Error(&quot;Missing testRailsOptions in wdio.conf&quot;); } if (options[name] == null) { throw new Error(`Missing ${name} value. Please update testRailsOptions in wdio.conf`); } } /** * @param {string} path * @return {string} * @private */ _url(path) { return `${this.base}?${path}`; } /** * @param {string} api * @param {*} body * @param {callback} callback * @param {callback} error * @return {*} * @private */ _post(api, body, error = undefined) { return this._request(&quot;POST&quot;, api, body, error); } /** * @param {string} api * @param {callback} error * @return {*} * @private */ _get(api, error = undefined) { return this._request(&quot;GET&quot;, api, null, error); } addTestPlanEntry(planId, suiteId, name, description, runs, caseIds) { return this._request( 'POST', `add_plan_entry/${planId}`, { 'include_all': this.options.includeAll, 'suite_id': suiteId, 'name': name, 'description': description, 'runs': runs, 'case_ids': caseIds }); } /** * @param {string} method * @param {string} api * @param {*} body * @param {callback} callback * @param {callback} error * @return {*} * @private */ _request(method, api, body, error = undefined) { let options = { headers: { &quot;Authorization&quot;: &quot;Basic &quot; + new Buffer(this.options.username + &quot;:&quot; + this.options.password).toString(&quot;base64&quot;), &quot;Content-Type&quot;: &quot;application/json&quot; }, }; if (body) { options['json'] = body; } let result = request(method, this._url(`/api/v2/${api}`), options); result = JSON.parse(result.getBody('utf8')); if (result.error) { console.log(&quot;Error: %s&quot;, JSON.stringify(result.body)); if (error) { error(result.error); } else { throw new Error(result.error); } } return result; } /** * @param {string} name * @param {string} description * @param {number} suiteId * @return {*} */ addRun(name, description, suiteId, caseIds) { return this._post(`add_run/${this.options.projectId}`, { &quot;suite_id&quot;: suiteId, &quot;name&quot;: name, &quot;description&quot;: description, &quot;assignedto_id&quot;: this.options.assignedToId, &quot;include_all&quot;: this.options.includeAll, &quot;case_ids&quot;: caseIds }); } /** * * @param {String} name * @param {String} description * @param {Array} testRuns */ addPlan(name, description, testRuns) { return this._post(`add_plan/${this.options.projectId}`, { &quot;name&quot;: name, &quot;description&quot;: description, &quot;entries&quot;: testRuns }); } /** * * @param {number} runId * @param {Array} cases */ addCasesToRun(runId, cases) { const currentCases = this._get(`get_tests/${runId}`).map(c =&gt; c.case_id); //console.log([...currentCases, ...cases]) this._post(`update_run/${runId}`, { 'case_ids': [...new Set([...currentCases, ...cases])] }); } getCasesForSuite(projectId, suiteId) { return this._get(`get_cases/${projectId}&amp;suite_id=${suiteId}`); } /** * Publishes results of execution of an automated test run * @param {string} name * @param {string} description * @param {Array.&lt;Object&gt;} results * @param {callback} callback */ publish(name, description, results, callback = undefined) { let runs = []; let body = null; let plan = null if (typeof this.options.suiteId !== 'number') { if (this.options.updatePlan) { //1. find our existing plan plan = this._get(`get_plan/${this.options.updatePlan}`); //console.log(plan); plan.entries.forEach(entry =&gt; { //console.log(entry.runs) const suiteInfo = this._get(`get_suite/${entry.runs[0].suite_id}`, callback); suiteInfo.cases = this.getCasesForSuite(this.options.projectId, suiteInfo.id).map(c =&gt; c.id); //console.log(suiteInfo); //console.log(results.filter(r =&gt; suiteInfo.cases.includes(r.case_id)).map(r =&gt; r.case_id)) const currentCases = this._get(`get_tests/${entry.runs[0].id}`).map(c =&gt; c.case_id); //add any missing test case ids to each run this._post(`update_plan_entry/${plan.id}/${entry.id}`, { case_ids: [...new Set([...currentCases, ...results.filter(r =&gt; suiteInfo.cases.includes(r.case_id)).map(r =&gt; r.case_id)])] }); body = []; body.push(this.addResultsForCases(entry.runs[0].id, results.filter(r =&gt; suiteInfo.cases.includes(r.case_id)))); }) } else { //1. create the test plan plan = this.addPlan(name, description, []); //2. for each suite, find the associated results for that suite &amp; add those to the correct runs in the test plan this.options.suiteId.forEach((suiteId, idx) =&gt; { const suiteInfo = this._get(`get_suite/${suiteId}`, callback); suiteInfo.cases = this.getCasesForSuite(this.options.projectId, suiteId).map(c =&gt; c.id); // update plan with test runs runs.push(this.addTestPlanEntry(plan.id, suiteId, suiteInfo.name, description, [{ 'name': suiteInfo.name, 'description': description, 'suite_id': suiteId, }], results.map(r =&gt; r.case_id)).runs[0]); //console.log(results.filter(r =&gt; suiteInfo.cases.includes(r.case_id))); body = []; body.push(this.addResultsForCases(runs[idx].id, results.filter(r =&gt; suiteInfo.cases.includes(r.case_id)))); //console.log(`Add updateRun:[${runs[idx].id}] to your config to update this run [${suiteInfo.name}].`); }); } console.log(`Results published to ${this.base}?/plans/view/${plan.id}`); console.log(`Add updatePlan: ${plan.id} to your config to update this plan.`); } else { if (this.options.updateRun) { //update run here runs[0] = { id: this.options.updateRun }; //add any missing test case ids to a run this.addCasesToRun(runs[0].id, results.map(r =&gt; r.case_id)); } else { runs.push(this.addRun(name, description, this.options.suiteId, results.map(r =&gt; r.case_id))); } body = this.addResultsForCases(runs[0].id, results); console.log(`Results published to ${this.base}?/runs/view/${runs[0].id}`); console.log(`Add updateRun: ${runs[0].id} to your config to update this run.`); } // execute callback if specified if (callback) { callback(body); } } /** * @param {number} runId * @param {Array.&lt;Object&gt;} results * * @return {Object} */ addResultsForCases(runId, results) { if (results.length &gt; 0) { return this._post(`add_results_for_cases/${runId}`, { results: results }); } } } module.exports = TestRail; Ã— Search results Close npm Module "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Modules Classes WdioTestRailCucumberReporter TestRail Ã— Search results Close npm Module "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Classes Classes WdioTestRailCucumberReporter TestRail Ã— Search results Close npm Module "},"index.html":{"id":"index.html","title":"Index","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Testrail Reporter for Webdriver.io using CucumberPushes test results into Testrail system.Fork from wdio testrail reporter Installation$ npm install wdio-testrail-cucumber-reporter --save-devUsageEnsure that your testrail installation API is enabled and generate your API keys. See http://docs.gurock.com/ Add reporter to wdio.conf.js: let WdioCucumberTestRailReporter = require('./packages/wdio-testrail-cucumber-reporter/lib/wdio-testrail-cucumber-reporter'); ... reporters: ['spec', WdioCucumberTestRailReporter], testRailsOptions: { domain: &quot;yourdomain.testrail.net&quot;, username: &quot;username&quot;, password: &quot;password&quot;, projectId: 1, suiteId: 1, runName: &quot;My test run&quot; }Mark your cucumber scenarios with ID of Testrail test cases. Ensure that your case ids are well distinct from test descriptions. Scenario: C123 C324 I should be able to navigate to the home page Scenario Outline: C123 C324 I should be able to navigate to the home pageOnly passed or failed tests will be published. Skipped or pending tests will not be published resulting in a &quot;Pending&quot; status in testrail test run. Optionsdomain: string domain name of your Testrail instance (e.g. for a hosted instance instance.testrail.net) username: string user under which the test run will be created (e.g. jenkins or ci) password: string password or API token for user projectId: number projet number with which the tests are associated suiteId: number suite number with which the tests are associated assignedToId: number (optional) user id which will be assigned failed tests Automatic creation of sections and casesYou can use next command to generate sections/cases based on your tests in test real: node scripts/generate-cases.js {path_to_your_wdio.conf} {path_to_your_mail_test_folders}Example:You have tests structure: - node_modules - test-project -- wdio.conf.js -- tests --- test-group-1 ---- test-1.js --- test-group-2 ---- test-sub-group-1 ----- test-2.js ----- test-3.js ---- test-sub-groop-2 ----- test-4.jsCommand: node node_modules/wdio-testrail-cucumber-reporter/scripts/generate-cases.js test-project/wdio.conf.js test-project/testswill create in test rail: section 'test-group-1' cases that are described in test-1.js inside section 'test-group-1' section 'test-group-2' subsection 'test-sub-group-1' inside section 'test-group-2' cases that are described in test-2.js inside subsection 'test-sub-group-1 cases that are described in test-3.js inside subsection 'test-sub-group-1 subsection 'test-sub-group-2' inside section 'test-group-2' cases that are described in test-4.js inside subsection 'test-sub-group-2 also test files (test-1.js - test-4.js) will be updated: id of case will be added to it() function References https://www.npmjs.com/package/mocha-testrail-reporter http://webdriver.io/guide/reporters/customreporter.html http://docs.gurock.com/testrail-api2/start Ã— Search results Close npm Module "},"module-lib_WdioTestRailCucumberReporter.html":{"id":"module-lib_WdioTestRailCucumberReporter.html","title":"Module: lib/WdioTestRailCucumberReporter","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Module: lib/WdioTestRailCucumberReporter Source: wdio-testrail-cucumber-reporter.js, line 1 Requires module:events module:./test-rail module:mocha-testrail-reporter/dist/lib/shared module:mocha-testrail-reporter/dist/lib/testrail.interface Classes WdioTestRailCucumberReporter Ã— Search results Close npm Module "},"module-lib_WdioTestRailCucumberReporter-WdioTestRailCucumberReporter.html":{"id":"module-lib_WdioTestRailCucumberReporter-WdioTestRailCucumberReporter.html","title":"Class: WdioTestRailCucumberReporter","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Class: WdioTestRailCucumberReporter lib/WdioTestRailCucumberReporter~ WdioTestRailCucumberReporter Class representing Cucumber reporter data and methods new WdioTestRailCucumberReporter(baseReporter, config) Parameters: Name Type Description baseReporter Object Configured in wdio.conf file config Object wdio config proprties Properties Name Type Description testRailsOptions Object wdio TestRail specifc configurations Properties Name Type Description domain string Domain for TestRail projectId number Project identifier suiteId Array.&lt;number&gt; List of suites identifiers assignedToId number User identifier username string User email password string User API key includeAll Boolean Flag to inlcude all tests from a suite in a run updateRun number Test run identifier for test run to update updatePlan number Test plan identifier for a test plan to update Source: wdio-testrail-cucumber-reporter.js, line 18 Extends events.EventEmitter Ã— Search results Close npm Module "},"TestRail.html":{"id":"TestRail.html","title":"Class: TestRail","body":" WDIO-Cucumber-TestRail Modules lib/WdioTestRailCucumberReporter Classes lib/WdioTestRailCucumberReporter~WdioTestRailCucumberReporterTestRail Class: TestRail TestRail TestRail basic API wrapper new TestRail(options) Parameters: Name Type Description options Object Source: test-rail.js, line 6 Methods addCasesToRun(runId, cases) Parameters: Name Type Description runId number cases Array Source: test-rail.js, line 152 addPlan(name, description, testRuns) Parameters: Name Type Description name String description String testRuns Array Source: test-rail.js, line 139 addResultsForCases(runId, results) Parameters: Name Type Description runId number results Array.&lt;Object&gt; Source: test-rail.js, line 253 Returns: Type Object addRun(name, description, suiteId) Parameters: Name Type Description name string description string suiteId number Source: test-rail.js, line 122 Returns: Type * publish(name, description, results, callback) Publishes results of execution of an automated test run Parameters: Name Type Description name string description string results Array.&lt;Object&gt; callback callback Source: test-rail.js, line 171 Ã— Search results Close npm Module "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
